<section fxLayout="row wrap" fxLayoutAlign="center center">
    <mat-card fxFlex="600px" fxFlex.xs="100%">
        <div fxLayout="column wrap" fxLayoutAlign="left left" fxLayoutGap="10px"
            [ngClass]="{'has-answered': hasAnswered, 'is-correct': isCorrect(), 'is-mostly-correct': isSimilarOnly() || isArtikelFehlerOnly() || isSimilarAndArtikelFehler(), 'is-wrong': isWrong() }">
            <mat-card-title>
                Übersetze ins Französische.
                <span *ngIf="!isProdMode"> (Id {{vokabel!.id}})</span>
                <div class="info-position">
                    <div *ngIf="!vokabel!.isInserted">{{getPosition()}}</div>
                    <div *ngIf="!vokabel!.isInserted">{{vokabel!.bereichName}}</div>
                    <div *ngIf="vokabel!.isInserted">Vorangegangene Vokabel</div>
                    <div class="wiederholung" *ngIf="vokabel!.wiederholung">{{vokabel!.wiederholung}}. Wiederholung
                    </div>
                </div>
            </mat-card-title>
            <div class="prev-error" *ngIf="vokabel!.isInserted">
                (Weil du <span class="word">{{vokabel!.reasonInserted}}</span> falsch hattest.)
            </div>
            <mat-card-content>
                <div class="question">
                    {{vokabel!.deu}}
                </div>
                <div class="solution">
                    <div *ngIf="hasAnswered && isCorrect()">
                        <p *ngIf="!vokabel!.wiederholung" class="heading">Richtig, sehr gut!</p>
                        <p *ngIf="vokabel!.wiederholung" class="heading">Richtig dieses Mal, sehr gut!</p>
                        <p class="truth">
                            <span class="result-correct" [innerHtml]="getHtmlStringTruth()"></span>
                            <span class="phonetik">[{{vokabel!.phonetik}}]</span>
                        </p>
                    </div>
                    <div *ngIf="hasAnswered && isSimilarOnly()">
                        <p class="heading">Fast richtig, achte auf Accents.</p>
                        <p class="truth">
                            <span class="result-accent-fehler" [innerHtml]="getHtmlStringTruth()"></span>
                            <span class="phonetik">[{{vokabel!.phonetik}}]</span>
                        </p>
                    </div>
                    <div *ngIf="hasAnswered && isArtikelFehlerOnly()">
                        <p class="heading">Fast richtig, achte auf den Artikel!</p>
                        <p class="truth">
                            <span class="result-artikel-fehler" [innerHtml]="getHtmlStringTruth()"></span>
                            <span class="phonetik">[{{vokabel!.phonetik}}]</span>
                        </p>
                    </div>
                    <div *ngIf="hasAnswered && isSimilarAndArtikelFehler()">
                        <p class="heading">Fast richtig, achte auf den Artikel und Accents.</p>
                        <p class="truth">
                            <span class="result-artikel-fehler-and-accent-fehler"
                                [innerHtml]="getHtmlStringTruth()"></span>
                            <span class="phonetik">[{{vokabel!.phonetik}}]</span>
                        </p>
                    </div>
                    <div *ngIf="hasAnswered && isWrong()">
                        <p class="heading" *ngIf="checkResult!.answerSan">Leider falsch, richtige Antwort:</p>
                        <p class="heading" *ngIf="!checkResult!.answerSan">Kein Problem, richtige Antwort:</p>
                        <p class="truth">
                            <span class="result-correct" [innerHtml]="getHtmlStringTruth()"></span>
                            <span class="phonetik">[{{vokabel!.phonetik}}]</span>
                        </p>
                    </div>
                </div>
                <form [formGroup]="vokabelForm" novalidate autocomplete="off">
                    <div class="input-group mb-2">
                        <input class="form-control form-control-lg" type="text" placeholder=".form-control-lg"
                            placeholder="Schreibe deine Antwort auf Französisch" formControlName="antwort" id="antwort"
                            (keydown.enter)="checkAnswer()" #refAntwort>
                        <div class="input-group-append result-info">
                            <div class="input-group-text is-correct" *ngIf="isCorrect()">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-check-circle"
                                    fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                                    <path fill-rule="evenodd"
                                        d="M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.236.236 0 0 1 .02-.022z" />
                                </svg>
                            </div>
                            <div class="input-group-text is-mostly-correct"
                                [ngClass]="{'male': checkResult!.isTruthArticleMasc, 'female': checkResult!.isTruthArticleFem}"
                                *ngIf="isArtikelFehlerOnly() || isSimilarAndArtikelFehler()">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-eye" fill="currentColor"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.134 13.134 0 0 0 1.66 2.043C4.12 11.332 5.88 12.5 8 12.5c2.12 0 3.879-1.168 5.168-2.457A13.134 13.134 0 0 0 14.828 8a13.133 13.133 0 0 0-1.66-2.043C11.879 4.668 10.119 3.5 8 3.5c-2.12 0-3.879 1.168-5.168 2.457A13.133 13.133 0 0 0 1.172 8z" />
                                    <path fill-rule="evenodd"
                                        d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z" />
                                </svg>
                            </div>
                            <div class="input-group-text is-mostly-correct"
                                *ngIf="isSimilarOnly() || isSimilarAndArtikelFehler()">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-exclamation-triangle"
                                    fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M7.938 2.016a.146.146 0 0 0-.054.057L1.027 13.74a.176.176 0 0 0-.002.183c.016.03.037.05.054.06.015.01.034.017.066.017h13.713a.12.12 0 0 0 .066-.017.163.163 0 0 0 .055-.06.176.176 0 0 0-.003-.183L8.12 2.073a.146.146 0 0 0-.054-.057A.13.13 0 0 0 8.002 2a.13.13 0 0 0-.064.016zm1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566z" />
                                    <path
                                        d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995z" />
                                </svg>
                            </div>
                            <div class="input-group-text is-wrong" *ngIf="isWrong()">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-x-circle"
                                    fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                                    <path fill-rule="evenodd"
                                        d="M11.854 4.146a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708-.708l7-7a.5.5 0 0 1 .708 0z" />
                                    <path fill-rule="evenodd"
                                        d="M4.146 4.146a.5.5 0 0 0 0 .708l7 7a.5.5 0 0 0 .708-.708l-7-7a.5.5 0 0 0-.708 0z" />
                                </svg>
                            </div>
                        </div>
                    </div>
                </form>
                <app-sonderzeichen-leiste [input]="antwort" [inputRef]="refAntwort"></app-sonderzeichen-leiste>
                <div class="info-progress">
                    <p *ngIf="numCorrectAnswersInRow >= TRESHOLDS[0]">
                        <span class="progress-text-info">
                            <span>{{numCorrectAnswersInRow}} richtige Antwort<span
                                    *ngIf="numCorrectAnswersInRow > 1">en</span> hintereinander!</span>
                            <span
                                *ngIf="numCorrectAnswersInRow >= TRESHOLDS[1] && numCorrectAnswersInRow < TRESHOLDS[2]">
                                Toll!</span>
                            <span *ngIf="numCorrectAnswersInRow >= TRESHOLDS[2]"> Du machst das super!</span>
                        </span>
                        <svg *ngIf="numCorrectAnswersInRow >= TRESHOLDS[1] && numCorrectAnswersInRow < TRESHOLDS[2]"
                            width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-emoji-smile progress-icon-info"
                            fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd"
                                d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                            <path fill-rule="evenodd"
                                d="M4.285 9.567a.5.5 0 0 1 .683.183A3.498 3.498 0 0 0 8 11.5a3.498 3.498 0 0 0 3.032-1.75.5.5 0 1 1 .866.5A4.498 4.498 0 0 1 8 12.5a4.498 4.498 0 0 1-3.898-2.25.5.5 0 0 1 .183-.683z" />
                            <path
                                d="M7 6.5C7 7.328 6.552 8 6 8s-1-.672-1-1.5S5.448 5 6 5s1 .672 1 1.5zm4 0c0 .828-.448 1.5-1 1.5s-1-.672-1-1.5S9.448 5 10 5s1 .672 1 1.5z" />
                        </svg>
                        <svg *ngIf="numCorrectAnswersInRow >= TRESHOLDS[2]" width="1em" height="1em" viewBox="0 0 16 16"
                            class="bi bi-emoji-sunglasses progress-icon-info" fill="currentColor"
                            xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd"
                                d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                            <path fill-rule="evenodd"
                                d="M4.285 9.567a.5.5 0 0 1 .683.183A3.498 3.498 0 0 0 8 11.5a3.498 3.498 0 0 0 3.032-1.75.5.5 0 1 1 .866.5A4.498 4.498 0 0 1 8 12.5a4.498 4.498 0 0 1-3.898-2.25.5.5 0 0 1 .183-.683zM6.5 6.497V6.5h-1c0-.568.447-.947.862-1.154C6.807 5.123 7.387 5 8 5s1.193.123 1.638.346c.415.207.862.586.862 1.154h-1v-.003l-.003-.01a.213.213 0 0 0-.036-.053.86.86 0 0 0-.27-.194C8.91 6.1 8.49 6 8 6c-.491 0-.912.1-1.19.24a.86.86 0 0 0-.271.194.213.213 0 0 0-.036.054l-.003.01z" />
                            <path
                                d="M2.31 5.243A1 1 0 0 1 3.28 4H6a1 1 0 0 1 1 1v1a2 2 0 0 1-2 2h-.438a2 2 0 0 1-1.94-1.515L2.31 5.243zM9 5a1 1 0 0 1 1-1h2.72a1 1 0 0 1 .97 1.243l-.311 1.242A2 2 0 0 1 11.439 8H11a2 2 0 0 1-2-2V5z" />
                        </svg>
                    </p>
                </div>
            </mat-card-content>
            <mat-card-actions align="start">
                <button mat-raised-button color="accent" [disabled]="hasAnswered || !isEmptyOrWhiteSpace(antwort.value)"
                    (click)="forceAnswer()">Ich weiß die
                    Antwort nicht</button>
                <button mat-raised-button color="primary"
                    [disabled]="!vokabelForm.valid || isEmptyOrWhiteSpace(antwort.value)" *ngIf="!hasAnswered"
                    (click)="checkAnswer()">Überprüfen</button>
                <button mat-raised-button color="primary" *ngIf="hasAnswered" (click)="proceed()"
                    #refFortsetzen>Fortsetzen</button>
            </mat-card-actions>
        </div>
    </mat-card>
</section>